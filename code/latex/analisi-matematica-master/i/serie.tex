\chapter{Serie}
Sia $\{a_n\}$ una successione a valori reali. Si costruisce una successione che è la somme dei termini di $a_n$ da 1 a $k$:
\[
A_k\defeq\sum_{n=1}^k a_n,
\]
detta \emph{serie} di termine generale $a_n$ e si indica con $\{A_k\}$. $A_k$ è la \emph{somma parziale} di $k$ elementi di $\{a_n\}$, e la serie è il limite per $k\to+\infty$ di questa somma parziale, e si indica con
\[
\sum_{n=1}^{+\infty}a_n.
\]
Il comportamento delle somme parziali, che è analogo a quello delle successioni, determina il comportamento della serie di termine generale:
\begin{itemize}
\item se $A_k$ converge, la serie converge;
\item se $A_k$ diverge, la serie diverge;
\item se $A_k$ oscilla, la serie oscilla o non ammette limite.
\end{itemize}
\begin{esempio} \label{es:serie-mengoli}
	Sia $a_n=\dfrac1{n(n+1)}$. La serie
	\[
	\sum_{n=1}^{+\infty}\frac1{n(n+1)}
	\]
	è detta \emph{serie di Mengoli}. Il suo termine generale si può scomporre come
	\[
	\frac1{n(n+1)}=\frac1{n}-\frac1{n+1},
	\]
	quindi la serie si sviluppa come
	\[
	\begin{split}
	A_k&=\sum_{n=1}^k\frac1{n(n+1)}=1-\frac12+\frac12-\frac13+\frac13-\frac14-\dots+\frac1{k}-\frac1{k+1}=\\
	&1-\frac1{k+1}\to 1.
	\end{split}
	\]
	Questa serie quindi converge a 1, perché $A_k$ converge a 1.
\end{esempio}
\begin{esempio} \label{es:serie-geometrica}
	Sia $a_n=q^n$. La serie
	\[
	\sum_{n=1}^{+\infty}q^n
	\]
	è detta \emph{serie geometrica di ragione} $q$. È determinata, se $q\neq 1$, dal comportamento della successione
	\[
	A_k=\sum_{n=0}^kq^n=1+q+q^2+\dots+q^k=\frac{1-q^{k+1}}{1-q}.
	\]
	Se $\abs{q}<1$, $q^{k+1}\to 0$ quindi la serie converge a $\frac1{1-q}$. Se invece $q>1$, si ha invece che $a_k\to+\infty$.
	Quando invece $q<-1$, la sottosuccessione $A_{2k}$ diverge a $+\infty$ mentre $A_{2k+1}$ a $-\infty$, quindi la serie è irregolare.
	Rimane il caso in cui $q=1$, in cui non si può applicare la precedente formula, ma banalmente è una somma di 1 infinte volte, che ovviamente diverge.
\end{esempio}

\section{Condizione di Cauchy}
Avendo dimostrato che $\R$ è completo (teorema \ref{t:completo}), la condizione di Cauchy è sufficiente a garantire la convergenza di una successione a valori reali. Poiché anche le serie numeriche sono rappresentate come successioni, si può applicare anche ad esse questa condizione, che si traduce in una forma particolare.
\begin{definizione}[Condizione di Cauchy]
\label{d:ccauchy_serie}
La serie $\sum_{n=1}^{+\infty}a_n$ soddisfa la condizione di Cauchy se per ogni $\epsilon>0$, $\exists p_0\colon\forall p\geq p_0$ e $\forall q\geq 0$ si ha
\begin{equation}
\label{eq:ccauchy_serie}
\abs[\bigg]{\sum_{n=p}^{p+q}a_n}<\epsilon,
\end{equation}
cioè la successione $\{A_k\}$ delle somme parziali soddisfa la condizione di Cauchy \ref{eq:ccauchy_successioni}.
\end{definizione}
Perché $\{A_k\}$ soddisfi la \ref{eq:ccauchy_successioni} deve essere che $\forall\epsilon>0$ esiste $N\colon\forall h,k\geq p_0$ si ha che
\[
	\abs{A_k-A_h}=\abs[\bigg]{\sum_{n=1}^ka_n-\sum_{n=1}^ha_n}=\abs[\bigg]{\sum_{n=h+1}^ka_n}<\epsilon.
\]
Sostituendo gli indici come $h=p-1$ e $k=p+q$ (con $q\geq 0$), l'equazione diventa
\[
	\abs{A_{p+q}-A_{p-1}}=\abs[\bigg]{\sum_{n=p}^{p+q}a_n}<\epsilon.
\]
Tutte le serie che soddisfano questa condizione sono convergenti.
\section{Carattere delle serie}
\begin{teorema}
Se $\sum_{n=1}^{+\infty}a_n$ converge, allora $\exists\lim_{n\to+\infty}a_n=0$.
\end{teorema}
\begin{proof}
Per ipotesi, se la serie converge allora $A_k$ è convergente ad un certo limite $S$. Si può scrivere che $a_n=A_n-A_{n-1}$. Poiché $A_k$ tende ad $S$, anche $A_n$ e $A_{n-1}$ tendono ad $S$, quindi la loro differenza tende a zero. Quindi
\[
\lim_{n\to+\infty}a_n=S-S=0.\qedhere
\]
\end{proof}
Il fatto che sia una condizione necessaria implica che se il limite della successione $a_n$ non è zero, la serie sicuramente non converge. Possono esistere però successioni convergenti, la cui serie diverge, come ad esempio la serie armonica $1/n$. Infatti, considerata la successione di somme parziali da $k$ a $2k$, questa è
\[
\sum_{n=k}^{2k}\frac1{n}=\frac1{k}+\frac1{k+1}+\frac1{k+2}+\dots+\frac1{2k}
\]
che, poiché il termine generale è monotono decrescente, è tutta sicuramente maggiore dell'ultimo addendo, $1/2k$, moltiplicato per $k$ volte (quanti sono gli elementi in questa somma), quindi
\[
\frac1{k}+\frac1{k+1}+\frac1{k+2}+\dots+\frac1{2k}>\frac1{2k}\cdot k=\frac12,
\]
cioè non soddisfa la condizione di Cauchy, quindi diverge.
\begin{definizione}
\label{d:conv_assoluta}
Si dice che la serie $\sum_{n=1}^{+\infty}a_n$ converge \emph{assolutamente} se la serie $\sum_{n=1}^{+\infty}\abs{a_n}$ converge.
\end{definizione}
\begin{teorema}
Se una serie converge assolutamente, allora converge anche semplicemente.
\end{teorema}
\begin{proof}
La serie di $\abs{a_n}$ converge, quindi soddisfa la condizione di Cauchy. Per le proprietà dei valori assoluti quindi si ha che, $\forall\epsilon>0$ $\exists N\colon\forall m\geq N$ e $\forall p\geq 0$,
\[
	\abs[\bigg]{\sum_{n=m}^{m+p}a_n}\leq\sum_{n=m}^{m+p}\abs{a_n}<\epsilon,
\]
e per il teorema del confronto \ref{t:confronto} entrambe le serie convergono.
\end{proof}
Non vale ovviamente il teorema inverso. La divergenza assoluta, ossia la relazione $\sum_{n=1}^{+\infty}\abs{a_n}=+\infty$, non fornisce in generale alcuna informazione sul carattere della serie: ad esempio la serie $\sum_{n=1}^{+\infty}(-1)^n$ oscilla, ma ovviamente diverge assolutamente.

\section{Serie a termini positivi}
In questa definizione rientrano tutte le serie il cui termine generale è \emph{definitivamente} positivo, non importa che lo sia sempre: infatti ai fini della convergenza importa soltanto il comportamento della ``coda'' della serie.
\begin{teorema}
Una serie a termini positivi è sempre regolare.
\end{teorema}
\begin{proof}
Se $a_n\geq 0$, allora $A_k$ è (definitivamente) monotona crescente. Poiché tutte le successioni monotone sono necessariamente regolari, allora la serie
\begin{itemize}
\item converge a una somma $S$ se $\{A_k\}$ è superiormente limitata;
\item diverge a $+\infty$ altrimenti.\qedhere
\end{itemize}
\end{proof}
\begin{teorema}[del confronto]
\label{t:confronto_serie}
Siano $\sum_{n=1}^{+\infty}a_n$e $\sum_{n=1}^{+\infty}b_n$ due serie a termini positivi, e sia definitivamente che $0\leq a_n\leq b_n$. Allora
\begin{itemize}
\item se $\sum_{n=1}^{+\infty}b_n$ converge, converge anche $\sum_{n=1}^{+\infty}a_n$;
\item se $\sum_{n=1}^{+\infty}a_n$ diverge (a $+\infty$), anche $\sum_{n=1}^{+\infty}b_n$ diverge.
\end{itemize}
\end{teorema}
\begin{proof}
Si considerino le successioni di somme parziali $A_k$ e $B_k$: esse sono entrambe (definitivamente) monotone crescenti, e si ha che $A_k\leq B_k$. Nel primo caso, $B_k$ converge, allora $A_k$ è superiormente limitata, e poiché è monotona converge anche.
Nel secondo caso, $A_k$ diverge quindi è superiormente illimitata dato che è monotona, allora anche $B_k$ deve essere superiormente illimitata, cioè diverge.
\end{proof}
\begin{esempio} \label{es:serie-confronto}
	Applichiamo il teorema del confronto nei seguenti esempi.
	\begin{enumerate}
		\item La serie di $1/\sqrt{n}$ diverge. Infatti si ha per ogni $n\geq 1$ che $\sqrt{n}\leq n$, quindi $\frac1{\sqrt{n}}\geq\frac1{n}$. Dato che la serie di $1/n$ diverge, per il teorema del confronto anche la serie $\sum_{n=1}^{+\infty}\frac1{\sqrt{n}}$ diverge.
		\item La serie di $1/\log n$ diverge, perché per ogni $n\geq 2$ si ha $n\geq\log n$ quindi $\frac1{n}\leq\frac1{\log n}$. Allora per il teorema del confronto la serie $\sum_{n=2}^{+\infty}\frac1{\log n}$ diverge.
	\end{enumerate}
\end{esempio}
\begin{corollario}
\label{c:confronto_asintotico}
Siano $\sum_{n=1}^{+\infty}a_n$ e $\sum_{n=1}^{+\infty}b_n$ due serie a termini positivi. Se $a_n\sim b_n$, le due serie hanno lo stesso carattere.
\begin{proof}
Se infatti le serie sono asintotiche, il loro rapporto e certamente anche il reciproco del rapporto tendono a 1. Quindi se $b_n/a_n\to 1$, è sicuramente contenuto in un intervallo arbitrario (con estremo inferiore positivo, perché le serie sono a termini positivi) che contiene 1, ad esempio $(1/2,2)$. Quindi
\[
\frac12<\frac{b_n}{a_n}<2\qqq\frac12b_n<a_n<2b_n.
\]
Poiché le costanti $1/2$ e 2 non alterano il carattere della serie di $b_n$, per il teorema \ref{t:confronto_serie} del confronto anche $b_n$ converge.
\end{proof}
\end{corollario}
\begin{teorema}[criterio della radice]
\label{t:criterio_radice_serie}
Sia $\sum_{n=1}^{+\infty}a_n$ una serie a termini positivi. Supponendo che $\exists\alpha\defeq\lim_{n\to+\infty}\sqrt[n]{a_n}$:
\begin{itemize}
\item se $0\leq\alpha<1$ la serie converge;
\item se $\alpha>1$ la serie diverge, e inoltre $a_n\to+\infty$.
\end{itemize}
\end{teorema}
\begin{proof}
1) Sia $0\leq\alpha<1$. Si può trovare un numero $q\in(\alpha,1)$ tale che definitivamente si abbia $\sqrt[n]{a_n}\leq q$. Allora si ha $a_n\leq q^n$. Poiché $q<1$, la serie $\sum_{n=1}^{+\infty}q^n$ converge, quindi per il teorema \ref{t:confronto_serie} del confronto anche $\sum_{n=1}^{+\infty}a_n$ converge.

2) Sia ora $\alpha>1$. Esiste un numero $p\in(1,\alpha)$ per cui definitivamente $\sqrt[n]{a_n}\geq p$, quindi $a_n\geq p^n$. Allora la serie diverge per il teorema del confronto, e $a_n$ tende a $+\infty$.
\end{proof}
Quando $\alpha=1$, come al solito, non si può dire niente sul carattere della serie. Infatti sia la serie di $1/n$ che di $1/n^2$ hanno $\alpha=1$, ma la prima diverge e la seconda converge.
\begin{teorema}[criterio del rapporto]
\label{t:criterio_rapporto_serie}
Sia $\sum_{n=1}^{+\infty}a_n$ una serie a termini positivi. Supponendo che $\exists\alpha\defeq\lim_{n\to+\infty}\frac{a_{n+1}}{a_n}$:
\begin{itemize}
\item se $\alpha<1$ la serie converge;
\item se $\alpha>1$ la serie diverge, e inoltre $a_n\to+\infty$.
\end{itemize}
\end{teorema}
\begin{proof}
1) Sia $0\leq\alpha<1$, allora esiste un numero $q\in(\alpha,1)$ per cui $\exists N\colon\forall n>N$ si ha che $\dfrac{a_{n+1}}{a_n}<q$. Allora per questi valori di $n$ si può scrivere $a_n$ come
\[
a_n=\frac{a_n}{a_{n-1}}\cdot a_{n-1}=\frac{a_n}{a_{n-1}}\cdot\frac{a_{n-1}}{a_{n-2}}\cdot\frac{a_{n-2}}{a_{n-3}}\cdot\dots\cdot\frac{a_{N+1}}{a_N}\cdot a_N.
\]
Tutti questi rapporti del tipo $a_k/a_{k-1}$ sono definitivamente minori di $q$, quindi
\[
a_n\leq q^n\,\frac{a_N}{q^N}.
\]
Poiché $q^n$ è una serie geometrica di ragione minore di 1, la sua serie converge, e per il teorema \ref{t:confronto_serie} del confronto anche la serie di $a_n$.

2) Sia ora $\alpha>1$. Allora si trova un numero $p\in(1,\alpha)$ per cui definitivamente $\dfrac{a_{n+1}}{a_n}>p$. Il termine $a_n$ si può riscrivere ancora come prima, ma questa volta tutti i termini sono maggiori di $p$. Allora
\[
a_n\geq p^n\,\frac{a_N}{p^N},
\]
e dato che $p^n$ è una serie geometrica di ragione maggiore di 1 la sua serie diverge a $+\infty$. Per il teorema del confronto quindi la successione $a_n$ tende a $+\infty$, e la serie di $a_n$ diverge.
\end{proof}
\begin{esempio} \label{es:serie-criterio-rapporto}
	Usiamo il criterio del rapporto nei seguenti esempi.
	\begin{enumerate}
		\item La serie di termine generale $1/n!$ converge. Infatti con il criterio del rapporto si ha $\dfrac{a_{n+1}}{a_n}=\dfrac{n!}{(n+1)!}=\dfrac1{n+1}\to 0$, quindi converge.
		\item La serie di termine generale $x^n/n!$ converge $\forall x\in\R$. Infatti con il criterio del rapporto risulta $\dfrac{a_{n+1}}{a_n}=\dfrac{\abs{x}^{n+1}}{(n+1)!}\,\dfrac{n!}{x^n}=\dfrac{\abs{x}}{n+1}\to 0$, quindi converge per qualunque valore di $x$ reale.
	\end{enumerate}
\end{esempio}

\begin{teorema}[criterio di condensazione]
Sia $\sum_{n=1}^{+\infty}a_n$ una serie a termini monotoni decrescenti, per cui $\forall n$ si ha $0<a_{n+1}\leq a_n$. Le serie
\[
\sum_{n=1}^{+\infty}a_n\qquad\text{ e }\qquad\sum_{n=1}^{+\infty}2^na_{2^n}
\]
hanno lo stesso carattere.
\end{teorema}
\begin{esempio} \label{es:serie-criterio-condensazione}
	Il criterio di condensazione si può rivelare utile con serie di potenze e logaritmi, come le seguenti.
	\begin{enumerate}
		\item Si consideri la serie $\sum_{n=1}^{+\infty}\frac1{n^p}$: con il criterio di condensazione si ha che essa ha lo stesso carattere della serie $\sum_{n=1}^{+\infty}2^n\dfrac1{(2^n)^p}=\sum_{n=1}^{+\infty}(2^{1-p})^n$, che è una serie geometrica di ragione $2^{1-p}$, che quindi converge se $p>1$, e diverge se $p\leq 1$.
		\item Si chiama \emph{serie campione} la serie $\sum_{n=1}^{+\infty}\dfrac1{n^p\log^q n}$, con $p,q\in\R$. Questa serie converge se $p>1$ e diverge se $p<1$, qualunque sia $q$; se invece $p=1$, allora converge se $q>1$ e diverge se $q\leq 1$.
	\end{enumerate}
\end{esempio}

\section{Serie a segni alterni}
Con serie a segni alterni si intendono le serie i cui termini sono in sequenza uno positivo, uno negativo, uno positivo, uno negativo e così via, o viceversa, cioè solo quelle il cui termine generale si può scrivere come $\sum_{n=1}^{+\infty}(-1)^na_n$. Per questo tipo di serie non valgono ovviamente tutti i teoremi elencati finora, ma ha una grande importanza il seguente \emph{criterio di Leibniz}.
\begin{teorema}[Leibniz]
\label{t:criterio_leibnitz}
Se $a_n$ è una successione defininitivamente positiva, monotona decrescente e convergente a 0, allora la serie a segni alterni
\[
\sum_{n=1}^{+\infty}(-1)^n a_n
\]
è convergente. Inoltre, indicata con $S$ la somma a cui la serie converge, si ha che $\abs{A_k-S}<a_{k+1}$, cioè l'errore che si compie troncando la serie a $n=k$, è sempre più piccolo del primo termine che si tralascia.
\end{teorema}
\begin{proof}
La successione delle somme parziali al termine dispari $2k+1$ è $A_{2k+1}=A_{2k-1}+(-1)^{2k}a_{2k}+(-1)^{2k+1}a_{2k+1}=A_{2k-1}+a_{2k}-a_{2k+1}$. La differenza $a_{2k}-a_{2k+1}$ è positiva, perché la successione è monotona decrescente, allora $A_{2k+1}\geq A_{2k-1}$. Quindi la sottosuccessione $A_{2k+1}$, di indice dispari, è monotona crescente. Analogamente, $A_{2k+2}=A_{2k}+(-1)^{2k+1}a_{2k+1}+(-1)^{2k+2}a_{2k+2}=A_{2k}-(a_{2k+1}-a_{2k+2})$, in cui per lo stesso motivo precedente $a_{2k+1}+a_{2k+2}$ è positivo, quindi $A_{2k+2}\geq A_{2k}$ e allora $A_{2k+2}$ (che è di indice pari) è monotona decrescente.
Si ha inoltre che $A_{2k+1}=A_{2k}-a_{2k+1}$ da cui $A_{2k+1}\leq A_{2k}$, dato che $a_{2k+1}<0$. Siano $S_p$ e $S_d$ i limiti a cui convergono rispettivamente le sottosuccessioni $A_{2k}$ e $A_{2k+1}$, poiché sono limitate e monotone, con $S_p\geq S_d$. Portando al limite per $n\to+\infty$ l'equazione $A_{2k+1}=A_{2k}-a_{2k+1}$ si ottiene che $S_d=S_p-0$ quindi $S_d=S_p$. L'unico limite della serie è allora $S_d=S_p=S$.

Inoltre, si ha che $A_{2k}-S\leq A_{2k}-A_{2k+1}=a_{2k+1}$, e analogamente $S-A_{2k+1}\leq A_{2k+2}-A_{2k+1}=a_{2k+2}$. Quindi in ogni caso risulta $\abs{A_k-S}<a_{k+1}$.
\end{proof}
\section{Convergenza incondizionata}
Su una serie di addendi si può effettuare l'operazione di \emph{permutazione}, che consiste nello scambiare l'ordine di alcuni addendi. Su una serie finita ovviamente il risultato non cambia, ma permutare una serie infinita può alterarne il carattere.
\begin{definizione}
Una serie converge \emph{incondizionatamente} se converge, e convergono tutte le sue permutate, cioè se la sua convergenza è invariante rispetto alla permutazione.
\end{definizione}
\begin{teorema}
Una serie converge incondizionatamente se e solo se converge assolutamente.
\end{teorema}
\begin{teorema}[Riemann]
Sia $\sum_{n=1}^{+\infty}a_n$ una serie convergente, semplicemente ma non assolutamente. Siano $\alpha,\beta\in\Rex$ con $\alpha\leq\beta$. Esiste sempre una permutazione di $\sum_{n=1}^{+\infty}a_n$ per cui la successione delle somme parziali di tale serie permutata abbia come limite massimo $\beta$ e come limite minimo $\alpha$.
\end{teorema}

\chapter{Metodi variazionali e di approssimazione}
\section{Il limite classico}
Nella meccanica classica la posizione e l'impulso sono grandezze precise e ben determinate, cosa che sappiamo non accade mai in ambito quantistico.
In alcuni casi potremmi riportarci al primo caso, ad esempio prendendo $\avg{q}$ e $\avg{p}$ alla stregua di variabili classiche se $\Delta q$ e $\Delta p$ sono trascurabili, in quanto i risultati veri mostrerebbero delle fluttuazioni attorno ai valori medi insignificanti.

Ammesso di trovare una situazione ``ideale'', essa può conservarsi nel tempo?
Traduciamo l'equazione di Newton usando i valori medi in $m\ddot{\avg{q}}=\avg{F(q)}$: in linea di principio però $F(\avg{q})\ne\avg{F(q)}$, cosa che accade solo se $F$ è lineare in $q$.
Sviluppando l'espressione della forza centrando in $\avg q$ troviamo $F(q)=F(\avg{q})+(q-\avg{q})F'(\avg{q})+o(q-\avg{q})$ che assume una forma \emph{approssimativamente lineare} quando il resto $o(q-\avg{q})$ è trascurabile.
Tale resto contiene come primo termine, oltretutto, lo scarto quadratico $(q-\avg{q})^2$, che è la quantità da minimizzare per poter compiere l'approssimazione con i valori medi.

Prendiamo il sistema di una particella libera: classicamente abbiamo le equazioni del moto $\dot{p}(t)=0$ e $\dot{q}(t)=\frac{p(t)}m$.
Chiamiamo direttamente $p(t)=p$, che è costante, ottenendo $q(t)=q(0)+\frac{p}{m}t$.
Risulta dunque
\begin{multline}
	\delta q(t)^2=\avg{q^2(t)}-\avg{q(t)}^2=\avg{q^2}+\frac{\avg{p^2}}{m^2}t^2+\frac{t}{m}(\avg{pq}+\avg{qp})-\avg{q}^2-\frac{\avg{p}^2}{m^2}t^2-\frac2{m}\avg{p}\avg{q}t=\\
	=\Delta q(0)^2+\frac{t}{m}(\avg{pq}+\avg{qp}-2\avg{p}\avg{q})+\frac{\Delta p(0)^2}{m^2}t^2
\end{multline}
che è l'equazione di una parabola.
Inesorabilmente quindi avremo $\Delta q(t)\sim\frac{\Delta p}{m}t$ per tempi molto grandi; possiamo concludere che $\Delta q(t)\sim 0$ se la massa della particella è molto grande.

\section{Approssimazione WKB}
Mostriamo il metodo di approssimazione dovuto a Wentzel, Kramers e Brillouin, detto anche \emph{approssimazione semiclassica}.
Consideriamo un sistema di una particella, in una dimensione: se il potenziale è costante, la soluzione dell'equazione di Schr\"odinger è una sovrapposizione di onde piane date da
\begin{equation}
	\psi(x)=\psi(0)e^{\pm ipx/\hbar}
\end{equation}
dove $p=\sqrt{2m(E-V)}$.
Supponiamo ora che $V(x)$, seppur non costante, vari ``lentamente'' in una regione di spazio: qui la funzione d'onda potrebbe essere approssimata proprio come un'onda piana.
Quanto lentamente deve variare il potenziale?
Per trovare la corretta approssimazione pensiamo al fatto che $\hbar$ sia una quantità piccola, trascurabile.
Scriviamo la funzione d'onda nella forma
\begin{equation}
	\psi(x)=e^{i\phi(x)/\hbar}
	\label{eq:WKB-funzione-prova}
\end{equation}
dove $\phi$ è una generica funzione complessa, che sviluppiamo in una serie di potenze di $\hbar$: ogni termine contiene una potenza $\hbar^k$ che moltiplica una certa funzione $\phi_k$, che possiamo vedere come una correzione sempre più fine, all'aumentare di $k$, alla vera funzione d'onda.
Ai nostri fini ci interessano i primi termini: $\phi=\phi_0+\phi_1\hbar+o(\hbar)$.
Prima di tutto calcoliamo le derivate della \eqref{eq:WKB-funzione-prova}: $\psi'=\frac{i}{\hbar}\phi'\psi$ e $\psi''=\frac{i}{\hbar}\phi''\psi-\frac1{\hbar^2}(\phi')^2\psi$.
Riscriviamo l'equazione di Schr\"odinger indipendente dal tempo come
\begin{equation}
	-\frac{\hbar^2}{2m}\psi''+\big[V-E\big]\psi=0\qqq \psi''+\frac{p^2}{\hbar^2}\psi=0
\end{equation}
dove $[p(x)]^2=\frac{2m}{\hbar^2}[E-V(x)]$ e inserendo la \eqref{eq:WKB-funzione-prova} otteniamo
\begin{equation}
	\frac{i}{\hbar}\phi''\psi-\frac1{\hbar^2}(\phi')^2\psi+\frac{p^2}{\hbar^2}\psi=0
\end{equation}
in cui possiamo semplificare $\psi$ in quanto non è mai nulla (è un'esponenziale).
Sostituiamo dunque $\phi$ con il suo sviluppo in serie di potenze di $\hbar$ fino al primo ordine: risulta
\begin{equation}
	\begin{gathered}
		\frac{i}{\hbar}\big[\phi_0''+\phi_1''\hbar+o(\hbar)\big]-\frac1{\hbar^2}\big[\phi_0'+\phi_1'+o(\hbar)\big]^2+\frac{p^2}{\hbar^2}=0\\
		\frac{i}{\hbar}\phi_0''+i\phi_1''+o(1)-\frac1{\hbar^2}\big[(\phi_0')^2+(\phi_1')^2\hbar^2+2\phi_0'\phi_1'\hbar+o(\hbar)\big]+\frac{p^2}{\hbar^2}=0\\
		\frac{i}{\hbar}\phi_0''+i\phi_1''+o(1)-\frac{(\phi_0')^2}{\hbar^2}-(\phi_1')^2-\frac{2\phi_0'\phi_1'}{\hbar}+o\Big(\frac1{\hbar}\Big)=0.
	\end{gathered}
\end{equation}
Moltiplicando tutto per $\hbar^2$ abbiamo
\begin{equation}
	i\hbar\phi_0''+i\hbar^2\phi_1''+o(\hbar^2)-(\phi_0')^2-\hbar^2(\phi_1')^2-2\hbar\phi_0'\phi_1'+p^2+o(\hbar)=0.
\end{equation}
Il termine $o(\hbar^2)$ e tutti gli altri che contengono $\hbar^2$ sono dunque ``assorbiti'' in $o(\hbar)$: abbiamo infine
\begin{equation}
	p^2-(\phi_0')^2+(i\phi_o''-2\phi_0'\phi_1')\hbar+o(\hbar)=0.
	\label{eq:WKB-schroedinger-approssimata}
\end{equation}

Possiamo effettuare dunque un'approssimazione all'ordine zero, cioè considerando solo i termini con la potenza $\hbar^0$ e trascurando i restanti: troviamo $\phi_0'=\abs{p}$, dunque la soluzione dell'equazione di Schr\"odinger con questa approssimazione è
\begin{equation}
	\psi(x)=Ae^{\pm\frac{i}{\hbar}\int p(x')\,\dd x'},
	\label{eq:soluzione-WKB-ordine-0}
\end{equation}
nel senso che una soluzione generale è combinazione lineare delle due onde (una per ciascun segno dell'esponente).
L'integrale è lasciato indefinito in quanto un'eventuale costante arbitraria è assorbita in $A$:
\begin{equation}
	\psi(x)=Ae^{\pm\frac{i}{\hbar}\int p(x')\,\dd x'+c}=Ae^ce^{\pm\frac{i}{\hbar}\int p(x')\,\dd x'}=\tilde{A}e^{\pm\frac{i}{\hbar}\int p(x')\,\dd x'}.
\end{equation}
A questo punto possiamo anche scegliere l'estremo inferiore di integrazione come un generico $x_0$ (nel dominio adatto), trovando
\begin{equation}
	\psi(x)=\psi(0)e^{\pm\frac{i}{\hbar}\int_{x_0}^x p(x')\,\dd x'}.
\end{equation}

Compiamo il passo successivo e consideriamo anche il termine del primo ordine: la funzione d'onda sarà dunque $\psi(x)=A\exp\big(\frac{i}{\hbar}\phi_0(x)+i\phi_1(x)\big)$.
Uguagliando a zero i due termini otteniamo per $\phi_0$ la stessa soluzione trovata poco fa, mentre per il termine in $\hbar$ abbiamo
\begin{equation}
	i\phi_0''=2\phi_0'\phi_1'\qqq \frac{\phi_0''}{\phi_0'}=-2i\phi_1'\qqq \log\phi_0'=-2i\phi_1+k
\end{equation}
per un $k\in\C$ generico.
Risolvendo per $\phi_1$ troviamo, ricordando che $\phi_0'=p$,
\begin{equation}
	\phi_1=\frac{i}2\log\phi_0'+c=i\log\sqrt{\abs{p}}+k'
\end{equation}
perciò la funzione d'onda approssimata è
\begin{equation}
	\psi(x)=Be^{\pm\frac{i}{\hbar}\int^xp(x')\,\dd x'+ik'-\log\sqrt{\abs{p}}}=\frac{B}{\sqrt{p}}e^{\pm\frac{i}{\hbar}\int^xp(x')\,\dd x'},
	\label{eq:soluzione-WKB-ordine-1}
\end{equation}
intendendo anche qui che la soluzione generale è combinazione lineare delle due funzioni, per ciascun segno.
È necessario infine discutere della validità di questa approssimazione: essa è valida se il termine in $\hbar$ è trascurabile, ossia se
\begin{equation}
    \hbar\abs[\bigg]{\drv{}{x}\frac1{p(x)}}\ll 1.
	\label{eq:condizione-approssimazione-WKB}
\end{equation}

Rimane comunque da discutere come raccordare le soluzioni tra le due parti del punto di inversione: in un intorno di tale punto infatti la \eqref{eq:condizione-approssimazione-WKB} certamente non è valida.
Se $x=a$ è un punto di inversione tale che la regione $x\le a$ è classicamente accessibile e $x>a$ non lo è, allora si può mostrare che la funzione d'onda nell'approssimazione semiclassica è
\begin{equation}
	\psi(x)=
	\begin{dcases}
		\frac{C}{2\sqrt{\abs{p(x)}}}\exp\bigg(-\frac1{\hbar}\int_a^xp(x')\,\dd x'\bigg)				&x>a\\
		\frac{C}{2\sqrt{\abs{p(x)}}}\cos\bigg(\frac1{\hbar}\int_a^xp(x')\,\dd x'+\frac{\pi}4\bigg)	&x\le a
	\end{dcases}
	\label{eq:wf-semiclassica}
\end{equation}

\section{Principi variazionali}
Spesso è necessario ricavare i livelli energetici, in particolare quello fondamentale, di un sistema anche quando la soluzione analitica è difficile da trovare.
A questo scopo è utile il metodo variazionale, che ha come punto di partenza la disuguaglianza
\begin{equation}
	E_0\le\frac{\bra{\psi}\op H\ket{\psi}}{\braket{\psi}{\psi}}
	\label{eq:principio-variazionale}
\end{equation}
per ogni stato $\ket{\psi}$ del sistema, dove $E_0$ è l'autovalore minimo dell'hamiltoniano, ossia il livello di energia dello stato fondamentale.
Infatti, espandendo il valore medio $\bra{\psi}\op H\ket{\psi}$ in una base di autostati $\ket{E_n}$ di $\op H$, otteniamo
\begin{equation}
	\bra{\psi}\op H\ket{\psi}=\sum_{n,m}\braket{\psi}{E_n}\bra{E_n}\op H\ket{E_m}\braket{E_m}{\psi}=\sum_{n,m}c_n^*E_m\delta_{nm}c_m=\sum_nE_n\abs{c_n}^2
\end{equation}
dove $c_j=\braket{E_j}{\psi}$.
D'altra parte si ha chiaramente $\braket{\psi}{\psi}=\sum_n\abs{c_n}^2$, perciò
\begin{equation}
	\frac{\bra{\psi}\op H\ket{\psi}}{\braket{\psi}{\psi}}=\frac{\sum_nE_n\abs{c_n}^2}{\sum_n\abs{c_n}^2}\ge\frac{\sum_nE_0\abs{c_n}^2}{\sum_n\abs{c_n}^2}=E_0.
\end{equation}
Possiamo interpretare la frazione come una media pesata degli autovalori $E_n$, dove i pesi sono dati da $\abs{c_n}/\sum_k\abs{c_k}^2$ (sono compresi tra 1 e 0 e la loro somma è 1).

Con questa disuguaglianza potremmo dunque determinare lo stato fondamentale di un sistema, calcolando il valore atteso di $\op H$ per tutti gli stati normalizzati e prendiamo il valore minimo; per ovvi motivi, non è una via perseguibile in pratica.
Ciò che si fa solitamente è considerare, invece che l'intero spazio degli stati possibili, un suo ragionevole sottoinsieme, i cui stati possono essere parametrizzati con delle variabili, in base alle caratteristiche di $\op H$ (in particolare, del potenziale).
Con questa restrizione il valore medio di $\op H$ nella \eqref{eq:principio-variazionale} diventa una funzione di queste variabili scelte, di cui possiamo comodamente calcolare il minimo, che è quindi una maggiorazione di $E_0$.
Ad esempio, se il potenziale è pari e vogliamo cercare lo stato fondamentale, proveremo uno stato caratterizzato da una funzione d'onda pari, senza nodi e che ovviamente sia a quadrato sommabile.
Una volta trovato un valore però non possiamo sapere, senza altre informazioni, se è una buona stima di $E_0$; potremmo addirittura trovare il valore esatto di $E_0$.
La bontà della stima è data innanzitutto da come modelliamo lo ``stato prova'' su cui calcoliamo $\bra{\psi}\op H\ket{\psi}$: ad esempio uno stato con funzione d'onda dispari e qualche nodo non darà certamente buoni risultati per lo stato fondamentale.
Possiamo ad esempio riprovare la stima questa volta aggiungendo altri parametri allo stato, cercando di trovare una stima di $E_0$ minore della precedente.
Più elaborato è il modello di prova, migliore sarà l'approssimazione: d'altro canto, continuando ad aggiungere parametri la mole di calcoli da compiere aumenta sempre di più, e potrebbe non valerne la pena se i miglioramenti su $E_0$ non sono apprezzabili.
Lo scopo di questo metodo è, in un certo senso, trovare la migliore approssimazione con il minor lavoro possibile.

